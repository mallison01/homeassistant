blueprint:
  name: Aeotec Siren 6 - Advanced Control (Fahrenheit)
  description: Trigger an Aeotec Siren 6 (ZW164) with customizable tones, volume, and duration based on selected door, temperature, or humidity sensors. This version uses Fahrenheit for temperature thresholds and provides a dropdown menu for tone selection.
  domain: automation
  author: Home Assistant Community
  input:
    siren_device:
      name: Siren Device
      description: The Z-Wave JS device for the Aeotec Siren 6.
      selector:
        device:
          integration: zwave_js
          manufacturer: Aeotec
          model: ZW164
    siren_tone:
      name: Siren Tone
      description: Select one of the 30 available tones by name.
      default: '1'
      selector:
        select:
          options:
            - label: "1. Ding Dong"
              value: '1'
            - label: "2. Ding Dong Tubular"
              value: '2'
            - label: "3. Traditional Apartment Buzzer"
              value: '3'
            - label: "4. Electric Apartment Buzzer"
              value: '4'
            - label: "5. Westminster Chimes"
              value: '5'
            - label: "6. Chimes"
              value: '6'
            - label: "7. Cuckoo"
              value: '7'
            - label: "8. Traditional Bell"
              value: '8'
            - label: "9. Smoke Alarm"
              value: '9'
            - label: "10. Smoke Alarm 2"
              value: '10'
            - label: "11. Fire Evacuation Buzzer"
              value: '11'
            - label: "12. CO Alarm"
              value: '12'
            - label: "13. Klaxon"
              value: '13'
            - label: "14. Deep Klaxon"
              value: '14'
            - label: "15. Warning Tone"
              value: '15'
            - label: "16. Tornado Siren"
              value: '16'
            - label: "17. Alarm"
              value: '17'
            - label: "18. Deep Alarm"
              value: '18'
            - label: "19. Alarm Archangel"
              value: '19'
            - label: "20. Alarm Shrill"
              value: '20'
            - label: "21. Digital Siren"
              value: '21'
            - label: "22. Alert Series"
              value: '22'
            - label: "23. Ship Bell"
              value: '23'
            - label: "24. Clock Buzzer"
              value: '24'
            - label: "25. Christmas Tree"
              value: '25'
            - label: "26. Gong"
              value: '26'
            - label: "27. Single Bell Ting"
              value: '27'
            - label: "28. Tonal Pulse"
              value: '28'
            - label: "29. Upward Tone"
              value: '29'
            - label: "30. Door Open"
              value: '30'
    siren_volume:
      name: Siren Volume
      description: Set the volume level of the siren (0-100%).
      default: 80
      selector:
        number:
          min: 0
          max: 100
          step: 1
          mode: slider
    siren_duration:
      name: Siren Duration
      description: The duration in seconds that the tone should play. Set to 0 for the default tone length.
      default: 5
      selector:
        number:
          min: 0
          max: 600
          step: 1
          mode: box
    enable_door_sensors:
      name: Enable Door/Window Sensors?
      description: Check this box to enable the door/window sensor trigger.
      default: false
      selector:
        boolean: {}
    door_sensors:
      name: Door/Window Sensors (Optional)
      description: Select door or window contact sensors that will trigger the alarm when opened. Only active if enabled above.
      default: []
      selector:
        entity:
          domain: binary_sensor
          device_class: door
          multiple: true
    enable_temp_sensors:
      name: Enable Temperature Sensors?
      description: Check this box to enable the temperature sensor trigger.
      default: false
      selector:
        boolean: {}
    temp_sensors:
      name: Temperature Sensors (Optional)
      description: Select temperature sensors to trigger the alarm. Only active if enabled above.
      default: []
      selector:
        entity:
          domain: sensor
          device_class: temperature
          multiple: true
    temp_threshold:
      name: Temperature Threshold
      description: Trigger the alarm when temperature goes above this value in Fahrenheit.
      default: 85
      selector:
        number:
          min: 0
          max: 200
          unit_of_measurement: "Â°F"
          step: 1
    enable_humidity_sensors:
      name: Enable Humidity Sensors?
      description: Check this box to enable the humidity sensor trigger.
      default: false
      selector:
        boolean: {}
    humidity_sensors:
      name: Humidity Sensors (Optional)
      description: Select humidity sensors to trigger the alarm. Only active if enabled above.
      default: []
      selector:
        entity:
          domain: sensor
          device_class: humidity
          multiple: true
    humidity_threshold:
      name: Humidity Threshold
      description: Trigger the alarm when humidity goes above this value.
      default: 70
      selector:
        number:
          min: 0
          max: 100
          unit_of_measurement: "%"
          step: 1

trigger:
  - platform: state
    entity_id: !input door_sensors
    to: 'on'
  - platform: numeric_state
    entity_id: !input temp_sensors
    above: !input temp_threshold
  - platform: numeric_state
    entity_id: !input humidity_sensors
    above: !input humidity_threshold

action:
  - choose:
      - conditions:
          - condition: or
            conditions:
              - condition: and
                conditions:
                  - condition: template
                    value_template: "{{ enable_door_sensors }}"
                  - condition: state
                    entity_id: !input door_sensors
                    to: 'on'
              - condition: and
                conditions:
                  - condition: template
                    value_template: "{{ enable_temp_sensors }}"
                  - condition: numeric_state
                    entity_id: !input temp_sensors
                    above: !input temp_threshold
              - condition: and
                conditions:
                  - condition: template
                    value_template: "{{ enable_humidity_sensors }}"
                  - condition: numeric_state
                    entity_id: !input humidity_sensors
                    above: !input humidity_threshold
        sequence:
          - service: zwave_js.set_config_parameter
            data:
              parameter: 37
              value: !input siren_duration
            target:
              device_id: !input siren_device
          - service: zwave_js.set_config_parameter
            data:
              parameter: 38
              value: !input siren_volume
            target:
              device_id: !input siren_device
          - service: zwave_js.set_config_parameter
            data:
              parameter: 39
              value: !input siren_tone
            target:
              device_id: !input siren_device
          - service: siren.turn_on
            target:
              device_id: !input siren_device

mode: single
